# SIR型の感染症数理モデル

## はじめに

感染症の脅威を感じ、数理モデルという言葉が、ニュースでも聞くようになった。僕は、社会実装からは少し離れて、感染症の数理モデルの解析や解析から予想されるアウトカムを研究の対象にしてきた。感染症流行における人為的介入やデータ解析には、僕の力ではとても触れる事ができないが、実装の背景にある数理については、及ばずながら、解説できるのかも知れないと考えた。

数学は、定量化できる現象について、洞察を得ようとする一面を持っている。ここに、感染症の流行と数学の接点が現れる。感染症の数理は、[1927年のKermackとMcKendrickらによる論文](https://link.springer.com/article/10.1007/BF02464423)を触れずして、語ることは難しい。彼らが考えた数理モデルはとても有用で、現代においても、中心的な役割を果たしている。ここでは、彼らが考えた数理モデルの本質を捕まえた基本的な**SIRモデル**と**基本再生産数**について説明してみたい。

以下記すことは、目新しいことではなくて、先駆者たちの[様々な文献](# further reading)に書かれてある。そちらで、より正確で包括的な知識が得られるであろう。これは、基本的な感染症数理モデルであるSIRモデルが、どのように作られるか、基本再生産数の概念がどのように生まれるか、僕なりの言葉で乱雑に焼き直したものである。

## SIRモデル：基本的な感染症数理モデル

現実の感染者数が、これから増加するか、または減少に転じるか？このような疑問に答えるには、我々の人口集団において、どのように感染者が生み出されるのか、に目を向ける必要があるだろう。感染症の流行は、感染者が感染者を作り出す、というプロセスによって引き起こされる。

時間$t$における感染者数を$I(t)$で表そう。この関数がどのように変化するか、考えてみたい。関数の微分を使って、感染者数の変化率は$I^\prime(t)$と表される。ざっくりと、
$$
I^\prime(t)=\lim_{h\to0}\frac{I(t+h)-I(t)}{h}\approx \frac{I(t+h)-I(t)}{h}
$$
であるから、$I^\prime(t)$は、感染者数の単位時間あたりの変化率を表している。

感染者数は、感染者と未感染者の接触による新規感染によって増加し、感染者が回復（または死亡）することで、減少する。つまり、感染者数の増減を決定する大きな要因は以下の2つである：

- 感染者と未感染者の接触による新規感染による増加
- 感染個体の回復（や死亡）による減少

感染者数の変化を数式で記述したものが感染症の数理モデルである。感染者数の変化率は、パラメータ$\beta$（感染係数）と$\gamma$（回復率）を用いて、
$$
I^\prime(t)=\underbrace{\beta S(t)I(t)}_{新規感染者数}-\underbrace{\gamma I(t)}_{回復者数}
$$
のように表される。ここで、$S(t)$は、時間$t$における未感染者数を表す（このような個体を感染症に感受性を持つ感受性保持者という）。未感染者数の変化は
$$
S^\prime(t)=-\underbrace{\beta S(t)I(t)}_{新規感染者数}
$$
と表される。式(3)は未感染者数が、新規感染によって、減少していくことを表している。

式(2)と(3)を合わせて、
$$
\begin{eqnarray}
S^\prime(t)&=&-\beta S(t)I(t)\\
I^\prime(t)&=&\beta S(t)I(t)-\gamma I(t)
\end{eqnarray}
$$
となる。この微分方程式(4)(5)を用いて、未感染者数と感染者数の変化を記述している。回復者数を$R(t)$として、
$$
R^\prime(t)=\gamma I(t)
$$
の式を付け加えることも多い。この式は、感染症から回復した個体が、回復者となることを表している。(4)(5)(6)式からなる系を**SIRモデル**と呼ぶ。

このような数理モデルが出来ると何が嬉しいか？一つの利点は、(4)-(6)式をコンピュータで、シミュレーションできることである。仮に$\beta,\gamma$のパラメータの値が分かっていれば、それを用いて感染者数の変化についてシミュレーションができるであろう([シミュレーション](# シミュレーション)で、パラメータを変えて、SIRモデルの計算を行っている)。

## 基本再生産数：流行初期の感染者数の動態

(2)式や(5)式を見るまでも無く、新規感染者数を完全に$0$に出来れば、感染症の流行を食い止めることができるであろう。どれくらい接触を食い止めれば、感染症の流行の食い止めが実現できるのか？**基本再生産数**は、このような疑問に答えるときに重要な概念となる。

流行初期において、人口集団にほぼ感染者がいないことを仮定すれば、全体の人口を$N$として、$S(t)\approx N$と定数で近似出来る。未感染者$S(t)$の変化を無視して、感染症の流行初期における感染者数の変化は次のように表される。
$$
I^\prime(t)=\beta NI(t)-\gamma I(t)
$$
(7)式の$\beta NI(t)$の係数$\beta N$は、単位時間に一人の感染者が作る新規感染者数である。また$\gamma$の逆数が$\displaystyle{\frac{1}{\gamma}}$が平均感染期間を表す事が知られている。よって、
$$
R_0:=\frac{\beta N}{\gamma}
$$
と定義される量は、「$1$人の感染者が平均感染期間に作り出す新規感染者数」と解釈できる。これを**基本再生産数**と呼び、$R_0$と表す。**基本再生産数**が$1$を上回れば、自然と感染症は流行し、逆に$1$を下回れば、感染症の流行は収まっていくだろう。人との接触率を$p\ (0\leq p\leq 1)$だけ下げれば、この指標が
$$
R_e=(1-p)R_0
$$
となり（実効再生産数）、これが$1$を下回るようにすれば良い。実効再生産数については、[新型コロナクラスター対策専門家@ClusterJapan](https://twitter.com/ClusterJapan/status/1247463049662889985)でも触れられ、8割の行動制限の必要性が説明されている。

## シミュレーション

$\gamma=1/10,\beta=2.5\times 1/10$とおいて（怪しい数値だが）、$R_0=2.5$のときのSIRモデルを計算すると、下のようなグラフが得られる。薄紅色の曲線が、感染者数の割合をプロットしたものである。横軸は時間を示している。

<img src="/Users/ynakata/Programs_Local/Program/Julia_code/Git/ODE/ODE_SIRModel/SIRODE1.png" style="zoom:14%;" />

上の図から、時間が経てば、感染者数はピークを迎えてから減っていく事がわかる。ただ、そのときの未感染者数の割合に着目して欲しい。感染症が収まる頃には、我々のほとんどが罹患している事が予想される。

接触率を下げて、$\beta=1.5\times 1/10$とすれば、モデルから異なる流行曲線を得る事ができる。$R_0=2.5$のときと$R_0=1.5$のときの流行曲線を比較したものが下のグラフである。

<img src="/Users/ynakata/Programs_Local/Program/Julia_code/Git/ODE/ODE_SIRModel/SIRODE2.png" style="zoom:14%;" />

基本再生産数$R_0$の変化によって、流行曲線の様子が変わることが見てとれる。これが、「患者の増加スピードを抑える」＋「流行の規模を下げ、患者数のピークを下げる」対策の背景である（[新型コロナウイルスに関するQ&A（一般の方向け）｜厚生労働省](https://www.mhlw.go.jp/stf/seisakunitsuite/bunya/kenkou_iryou/dengue_fever_qa_00001.html)）。すなわち、接触率を下げ、基本再生産数を下げ、流行曲線がなだらかになることを目指している。

## 最後に

SIRモデルはとても単純化されたモデルである。感染者の潜伏期間は無視されているし、感染者の異質性も無視されている。またこのような方程式では、回復期間は指数分布に従う、という仮定がおかれている。ここでは死亡する個体を考えていない。etcetc. 

しかしながら、SIRモデルは、感染者数の増減の要因の本質を記述し、それから感染症の流行動態の描像を描くものとなっている。我々がこの数理モデルから学べることは少なくない。

SIRモデルの大きな仮定は、感染症からの回復者がみな免疫を持つ、という点である。この仮定のために、時間が十分経てば、我々は集団免疫を獲得し、感染者数はやがて$0$に収束する。これは果たしてCoronavirus disease 2019 (COVID-19)で 満たされているだろうか。また、型が違うウイルスが集団に入ってきているとすると、このSIRモデルで得られる洞察は、そのまま成り立つだろうか。

数理モデルのブラッシュアップや解析は、現在でも計算機の手が届かない、とても人間らしい作業で、それが我々に必要だと思っている。どのようなモチベーションであれ、感染症の数理に興味を持つ人が増えれば、僕は嬉しく、それが、我々の目前にある現象を理解することにつながると信じている。

## FURTHER READING

SIRモデルの数理的な側面に関しては、以下のテキストに纏まっている。

[稲葉寿 「感染症の数理モデル」(2008) 培風館]([https://www.amazon.co.jp/%E6%84%9F%E6%9F%93%E7%97%87%E3%81%AE%E6%95%B0%E7%90%86%E3%83%A2%E3%83%87%E3%83%AB-%E7%A8%B2%E8%91%89-%E5%AF%BF/dp/4563011371](https://www.amazon.co.jp/感染症の数理モデル-稲葉-寿/dp/4563011371))（手に入れるのが困難であるが。。）

[稲葉寿 「数理人口学」(2002) 東大出版](https://www.amazon.co.jp/%E6%95%B0%E7%90%86%E4%BA%BA%E5%8F%A3%E5%AD%A6-%E7%A8%B2%E8%91%89-%E5%AF%BF/dp/413066901X)

[稲葉寿, 微分方程式と感染症数理疫学, 数理科学 46(4)  (2008) pp. 19-25](https://www.ms.u-tokyo.ac.jp/~inaba/inaba_science_2008.pdf)

数理モデルによる疫学データの扱い方については、[西浦博, 稲葉寿, 感染症流行の予測：感染症数理モデルにおける定量的課題, 統計数理 54(2) (2006) 461-480](https://www.ism.ac.jp/editsec/toukei/pdf/54-2-461.pdf)や、[稲葉寿 「感染症の数理モデル」(2008) 培風館]([https://www.amazon.co.jp/%E6%84%9F%E6%9F%93%E7%97%87%E3%81%AE%E6%95%B0%E7%90%86%E3%83%A2%E3%83%87%E3%83%AB-%E7%A8%B2%E8%91%89-%E5%AF%BF/dp/4563011371](https://www.amazon.co.jp/感染症の数理モデル-稲葉-寿/dp/4563011371))の2章に書かれている。

